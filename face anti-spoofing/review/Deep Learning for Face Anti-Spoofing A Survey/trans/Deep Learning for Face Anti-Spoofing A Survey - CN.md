# Deep Learning for Face Anti-Spoofing: A Survey

## 3. 使用商用RGB相机的深度FAS

由于商用RGB相机在许多真实世界应用场景(如，权限控制系统和移动设备解锁)中已经广泛使用，在这一章节，我们将回顾现有的基于商用RGB相机的FAS方法。图6介绍了几个具有里程碑意义的深度FAS方法。

### 3.1 混合方法(手工+深度学习)

虽然深度学习和CNN在许多计算机视觉任务(如，图像分类[104]、[105]，语义分割[106]，物体检测[107])中取得了巨大的成功，由于训练数据的数量和种类有限，它们容易在FAS任务中遭受到过拟合的问题。由于手工特征(LBP描述子[108]，HOG描述子[109]，图像质量[110]，光流运动[111]，和rPPG线索[112])已经被证明具有将真实和PA区分开来的判别能力，一些近期的混合works针对FAS把手工特征和深度特征组合起来。(附录)表-A5总结了这些混合方法的典型属性。

一些FAS方法首先从人脸输入中提取手工特征，然后使用CNN做语义特征表征(范例见图7(a))。一方面，基于颜色纹理的静态特征从每一帧中提取出来，随后被送入深度模型。基于丰富的low-level纹理特征，深度模型可以挖掘纹理感知的语义线索。为此，Cai和Chen[113]采用了多尺度颜色LBP特征作为局部纹理描述子，随后串联一个随机森林用于语义表征。类似的，Khammari[22]提取了LBP和Weber局部描述子编码的CNN特征，它们可以联合使用来保留局部强度和边缘方向信息。然而，与原始人脸输入相比，基于局部描述子的特征丢失了像素级别的细节，因此限制了模型的表现。另一方面，跨越时间的动态特征(如，运动，光照变化，生理信号)也是有效的CNN输入。Feng et al.[114]提出从提取的基于稠密光流的运动中，训练一个多层感知器，它可以揭示打印攻击的异常。此外，Yu et al.[115]从人脸视频中构建了空间－时间rPPG图，并使用了一个视觉transformer来捕捉活体样本里周期性的心跳活体特征。然而，头部运动和rPPG信号在重放攻击中容易被模仿，使得这类动态线索不可靠。重放攻击通常存在异常的反射变化，基于这个事实，使用来自反射率图像的强度差异直方图作为输入，Li et al.[116]提出使用一个1D CNN来捕捉这类光照变化。

其它一些混合FAS方法从深度卷积特征中提取手工特征，它们跟随图7(b)所示的混合框架。为了降低与FAS无关的冗余，Li et al.[30]利用分块主成分分析(Block PCA)从预训练的VGG-face模型中过滤掉了与深度无关的特征。除了基于PCA的降维之外，Agarwal et al.[117]从浅卷积特征中显式提取了彩色LBP描述子，它包含了丰富的low-level统计信息。除了静态欺骗样式，一些works也在训练好的深度模型中探索手工动态时间线索。Asim et al.[20]和Shao et al.[118]分别使用LBP-TOP[119]和光流各自从序列卷积特征中提取深度动态纹理和运动特征。这种混合框架的一个限制是，手工特征高度依赖于训练好的卷积特征，并且依然不清楚，对于不同种类的手工特征，浅卷积特征或者深度卷积特征哪个更合适。

由于手工特征和深度卷积特征持有不同的属性，另一种受欢迎的混合框架(见图7(c))将它们融合起来以用于更通用的表征。为了提供更加可靠的预测，Sharifi[120]提出融合来自手工LBP特征和深度VGG16模型的预测分数。然而，为这两种特征确定最优的分数权重是具有挑战性的。除了分数级别的融合，Rehmana et al.[21], [121]提出利用HOG和LBP图来扰动和调节low-level卷积特征。尽管事实是来自手工特征的局部先验知识可以提升判别能力，但总的模型会遭受到语义表征降级的问题。根据时间方法，为了充分利用真实与PA之间的动态差异，Li et al.[122]通过1D CNN提取了强度变化特征，它与来自运动放大人脸视频的运动模糊特征融合，用于重放攻击检测。

总之，受益于显式专家设计的特征提取，混合方法可以表示特殊的非纹理线索(如，时间的rPPG和运动模糊)，通过端到端的基于纹理的FAS模型则很难捕捉到这些。然而，缺点也很明显：1) 手工特征高度依赖于专家知识并且不可学习，一旦有足够的训练数据可用，这种方法会变得效率低下；2) 手工特征和深度特征之间可能存在特征间隙/不兼容，它会导致性能饱和。

### 3.2 传统深度学习方法

得益于高级CNN架构的发展[105]、[123]，正则化技术[124]、[125]以及近年来发布的大规模FAS数据集[44]、[59]、[77]，端到端的深度学习方法越来越受到关注，并且主导了FAS领域。混合方法集成了部分手工特征，并且不需要学习参数，与此不同，基于传统深度学习的方法直接学习到从人脸输入到欺骗检测之间的映射函数。传统深度学习框架通常包括：1) 使用二元交叉熵损失函数的直接监督(见图8(a))；2) 使用辅助任务的像素级监督(见图8(b))或使用生成模型的像素级监督(见图8(c))。

#### 3.2.1 使用二元交叉熵损失函数的直接监督

由于FAS直觉上可以看做二分类(真实 vs. PA)任务，许多端到端的深度学习方法使用二元交叉熵(CE)损失函数以及扩展的损失函数(如，三元损失函数[126])来直接进行监督学习。(附录)表-A6总结了这些方法。

一方面，研究人员针对FAS提出了通过二元交叉熵损失函数监督学习的不同网络架构。Yang et al.[29]使用8层浅CNN用于特征表征，提出了第一个端到端的深度FAS方法。然而，由于数据集有限的规模和多样性，基于CNN的方法容易在FAS任务中产生过拟合。为了缓解这个问题，一些works[127]、[128]、[129]针对FAS，对ImageNet预训练模型(如，VGG16, ResNet18和vision transformer)进行了微调。对于移动级别的FAS应用，Heusch et al.[55]采用了轻量级的MobileNetV2[130]来进行更高效FAS。上述提到的通用骨干网络通常关注high-level语义表征，忽略了low-level的特征，而这些特征对于欺骗方式的挖掘也很重要。为了更好的使用多尺度的特征，Deb和Jain[131]提出了使用浅全连接卷积网络(FCN)以自监督方式从人脸图像中学习局部判别线索。在基于单帧的外观特征之外，一些works[25]、[132]、[133]、[134]考虑真实样本和PA在时间上的差异性，并且使用LSTM[135]串联了多帧CNN特征以实现更健壮的动态线索传播。

另一方面，考虑到二元交叉熵的类内和类间限制较弱，一些works通过修改二元交叉熵损失函数来为CNN提供更具有判别性的监督信号。取代二元限制，Xu et al.[100]将FAS重新表达为一个细粒度的分类问题，并且将类型标签(如，真实，打印攻击，重放攻击)用于多类别监督。用这种方法，PA的一些特殊的属性可以被表示(如，材质)。然而，尤其在比较困难的活体/欺骗样本中，使用多类别交叉熵损失函数监督训练的模型，依然存在混乱的活体/欺骗分布。例如，高保真的PAs与对应的真实样本具有相似的外观线索。一方面，为了学习到类内间距小，类间间距大的紧致空间，Hao[136]和Almeida[80]分别各自引入了对比损失函数和三元损失函数。然而，与视觉检索任务不同，FAS任务中的真实与欺骗通常具有不对称的类内分布(更加紧致，更加多样性)。基于此，Wang et al.[101]提出通过非对称angular-margin softmax损失函数来放松类内PA之间的限制，来监督FAS补丁模型。另一方面，为了在困难样本上提供更加自信的预测，Chen et al.[137]采用二元焦点损失函数来指导模型放大活体/欺骗样本之间的边缘，并且在困难样本上实现了很强的判别性能。

总的来说，两类方法便于使用，且模型可以快速收敛。然而，对于活体/欺骗嵌入学习来说，这些监督信号只提供全局性(空间/时间)的限制，可能导致FAS模型对于unfaithful patterns容易过拟合。此外，二元监督的FAS模型通常是黑盒，并且学习到的特性也很难理解。

#### 3.2.2 像素级监督

直接通过二元损失函数监督的深度模型容易学习到unfaithful patterns(如，屏幕边框)。相反，对于更好的内在特征学习，像素级监督可以提供更加细粒度的和任务相关的上下文线索。一方面，根据物理线索和判别设计原理，辅助监督信号，如伪深度标签[13]、[26], 二元面具标签[32]、[38]、[39], 和反射图[24]、[36]，被用来做局部的活体/欺骗线索描述。另一方面，带有显式像素级监督和生成模型(如，原始人脸输入重建[42]、[138])最近被用于通用欺骗样式的估计。我们在(附录)表-A7中总结了代表性的像素级监督方法。

##### 使用辅助任务的像素级监督

根据人类FAS先验知识，很多PA(如普通的打印纸和电子屏幕)仅仅没有真实的深度信息，这可以被用作判别监督信号。因此，一些近期的works[23]、[26]、[96]、[139]采用像素级伪深度标签来指导深度模型，强制模型对活体样本预测真实的深度，而将欺骗样本映射为0。Atoum et al.[26]第一个使用伪深度标签来指导多尺度FCN(即简称DepthNet)。因此，训练好的DepthNet可以预测整体深度图作为决策根据。为了进一步提高细粒度内在特征表征能力，Yu et al.[23]使用中心差分卷积(CDC)替换了DepthNet中的普通卷积，从而形成了CDCN架构(详细结构见图9)。在静态架构方面，由于紧致性和优秀表现，DepthNet和CDCN是最受欢迎的，并且广泛应用在深度FAS社区。许多近期的变种[37]、[98]、[140]基于DepthNet/CDCN构建。至于时间架构，经典的FAS-SGTD[96]因它对短期和长期微运动优秀的估计而出名，它可以用于精准的脸部深度预测。FAS-SGTD的详细架构见图10，它是在一个transformer对应的架构[141]上后边经过修改和扩展而来。

为每一个训练样本合成3D形状标签成本高且不够精确，并且对于具有深度信息的PA类型(如，3D面具和人体模型)来说也缺乏合理性。相反，二元面具标签[32]、[38]、[99]、[142]、[143]更容易生成，且更容易泛化到所有PA。特别的，对于每个空间位置上，二元监督可以为深度内嵌特征提供。换句话说，通过二元面具标签，可以在对应的补丁里发现是否有PA出现，即它是攻击类型不可知，并且空间可解释的。George和Marcel[32]是第一个引入深度像素级二元监督，用来为串联的最终二元分类来预测中间的置信图。由于充足的像素级监督，骨干网络DenseNet121收敛良好，并且可以提供补丁级别的活体/欺骗预测。由于细微的欺骗线索(如，莫尔条纹)通常存在于不同的空间区域，具有不同的强度，普通的像素级二元监督把所有的补丁看成具有相等的贡献，这可能会导致有偏向的特征表征。为了解决这个问题，Hossaind et al.[142]提出在计算深度像素级二元损失之前，为特征改进增加一个可学习的注意力模块，它对显著的信息传播有用。虽然灵活且易于使用，但是当前的二元面具标签通常假定脸部区域的所有像素具有相同的活体/欺骗分布，因此分别为真实或者PA生成全部1或者全部0的映射。然而，当遇到部分攻击时(如，funny eyes)，这些标签不精确且有噪声。

除了主流的深度图和二元面具标签，还有几个信息量大的辅助监督(如，伪反射图[24]、[36]、[44]，3D点云图[40]，三元图[39]，和傅里叶光谱[144])。根据活体皮肤和欺骗媒介反射率在脸部材质相关的反射率不同，Kim et al.[36]提出同时使用深度和反射标签，来监督深度模型。此外，为了进一步提升类型不可知的泛化能力，有人引入了二元面具图[24]，同时使用这三个像素级监督来训练双边卷积网络。不像二元面具标签会考虑所有空间位置，包括与活体/欺骗无关的背景，Sun et al.[39]移除了脸部无关的部分，留下整个脸部区域作为一个改进的二元面具，叫做“三元图”，它消除了脸部之外的噪音，并且对脸部欺骗线索挖掘有用。基于真实与PA之间丰富的纹理和几何差异，使用来自傅里叶图[33]、[144]，LBP纹理图[97]，和稀疏3D点云图[40]的其它辅助监督的深度模型也显示出它们优秀的表征能力。

总的来说，像素级辅助监督有益于物理意义，可解释性的活体/欺骗特征学习(如，反射和深度监督分别对应于材质与几何表征)。此外，以一个多任务学习的方式[24]，通过综合使用多个补充的辅助像素级监督(如，深度，反射，反射率)，可以训练出可靠的且泛化性好的FAS模型。然而，需要提到辅助监督的两个限制：1) 依赖于高质量(如，高分辨率)的训练数据，当训练数据太noisy并且质量较低时，难以提供有效的监督信号；2) 伪辅助标签是人工设计或者是其它现成算法生成的，并不总是可靠。

##### 使用生成模型的像素级监督

虽然有辅助任务的细粒度的监督信号，深度黑盒模型是否真的表示内在的FAS特征，依然很难理解。最近，一个热门的趋势是，挖掘存在于欺骗样本中的视觉欺骗样式，旨在为样本的spoofness提供一个更加直观的解释。我们在(附录)表-A7的底部总结了这种使用生成模型的像素级监督方法。考虑到辅助的像素级监督强烈的受物理影响的限制，一些works将这种显式的监督信号放松，并且提供一个更宽的空间用来挖掘隐式欺骗线索。Jourabloo et al.[33]将FAS重新表达成一个欺骗噪声建模问题，并且设计了一个编码器-解码器架构，使用放松的像素级监督(如，活体人脸是零噪音图)来估计底层欺骗样式。使用这种针对真实样本单方面的限制，模型可以灵活挖掘PA的欺骗线索。类似的，Feng et al.[41]设计了一个欺骗线索生成器来最小化活体样本的欺骗线索，同时对于欺骗样本不加任何显式限制。与上面提到的对活体样本强行加上严格的限制的works不同，Mohammadi et al.[138]使用了一个重建错误图来进行欺骗检测，它通过一个活体人脸预训练的自动编码器计算得来。由于这种错误图从重建活体人脸的残留噪声中生成，没有人工定义的元素，它们在知识线索改变的域变换下是健壮的。然而，由自动编码器而来的低质量的重建人脸，可能会导致有噪音的残差错误图。

除了直接的欺骗样式生成之外，Qin et al.[43]提出通过一个meta-teacher框架，自动生成像素级标签，它可以为学生FAS模型提供更合适的监督，以学习足够的和内在的欺骗线索。然而，在其工作当中，只有可学习的欺骗监督[43]生成出来。因此，如何为活体样本和欺骗样本自动生成最优的像素级信号依然值得探索。

总的来说，使用生成模型的像素级监督通常会放宽专家设计的硬限制(如，辅助任务)，使得解码器重建更加自然的欺骗相关的线索。因此，预测的欺骗样式具有更强的数据驱动性和良好的可解释性。生成的欺骗样式是可见地有洞察力的，并且用人类先验知识来人工描述是很有挑战性的。然而，这种软的像素级监督在未知干扰(如，传感器噪音)容易陷入局部最优且过拟合，在真实世界场景下会导致泛化糟糕。将显式辅助监督和基于监督的生成模型联合训练，可能会缓解这个问题。
